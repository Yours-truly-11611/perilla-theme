{{ define "main" }}
{{ if .Params.heroImage }}
  {{ if .Params.heroFull }}
  <section class="hero" aria-label="{{ .Title }} hero">
    <div class="hero__bg"
         style="background-image: url('{{ .Params.heroImage | relURL }}');
                background-color: {{ .Params.heroTintColor | default "rgba(30,20,40,0.55)" }};">
    </div>
    <div class="hero__content">
      <h1 class="hero__title">{{ .Title }}</h1>
      {{ with .Params.heroSubtitle }}
        <p class="hero__subtitle">{{ . }}</p>
      {{ end }}
    </div>
    <a href="#page-content" class="hero__scroll-hint" aria-label="Scroll to content">
      <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </a>
  </section>
  {{ else }}
  <section class="hero-split" aria-label="{{ .Title }} hero">
    <div class="hero-split__title-block">
      <h1 class="hero-split__title">{{ .Title }}</h1>
      {{ with .Params.heroSubtitle }}
        <p class="hero-split__subtitle">{{ . }}</p>
      {{ end }}
    </div>
    <div class="hero-split__image" role="button" tabindex="0" aria-label="View full image">
      <img src="{{ .Params.heroImage | relURL }}" alt="{{ .Title }}" />
    </div>
  </section>

  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="lightbox__backdrop"></div>
    <div class="lightbox__content">
      <img class="lightbox__img" src="{{ .Params.heroImage | relURL }}" alt="{{ .Title }}" />
      {{ with .Params.heroImageDesc }}<p class="lightbox__caption">{{ . }}</p>{{ end }}
    </div>
  </div>
  {{ end }}
{{ end }}

<main id="page-content" class="site-content">
  <div class="container">
    <article class="article">
      {{ if not .Params.heroImage }}
      <header class="article__header">
        <h1 class="article__title">{{ .Title }}</h1>
        {{ if not .IsPage }}
          <time class="article__date" datetime="{{ .Date.Format "2006-01-02" }}">
            {{ .Date.Format "January 2, 2006" }}
          </time>
        {{ end }}
      </header>
      {{ end }}

      <div class="article__body">
        {{ .Content }}
      </div>
    </article>

    <!-- Back link -->
    <a href="{{ "/" | relURL }}" class="article__back">&larr; Back</a>
  </div>
</main>

<script>
(function () {
  var trigger = document.querySelector('.hero-split__image');
  var lightbox = document.getElementById('lightbox');
  if (!trigger || !lightbox) return;

  function open() {
    lightbox.classList.add('is-active');
    lightbox.setAttribute('aria-hidden', 'false');
  }
  function close() {
    lightbox.classList.remove('is-active');
    lightbox.setAttribute('aria-hidden', 'true');
  }

  trigger.addEventListener('click', open);
  trigger.addEventListener('keydown', function (e) {
    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); open(); }
  });
  lightbox.querySelector('.lightbox__backdrop').addEventListener('click', close);
  lightbox.addEventListener('keydown', function (e) {
    if (e.key === 'Escape') close();
  });
})();
</script>
{{ end }}
